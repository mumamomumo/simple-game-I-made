(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();const E={context:void 0,registry:void 0,effects:void 0,done:!1,getContextId(){return cn(this.context.count)},getNextContextId(){return cn(this.context.count++)}};function cn(n){const e=String(n),t=e.length-1;return E.context.id+(t?String.fromCharCode(96+t):"")+e}function Qe(n){E.context=n}const Es=(n,e)=>n===e,X=Symbol("solid-proxy"),Gn=typeof Proxy=="function",qt=Symbol("solid-track"),mt={equals:Es};let zn=Xn;const ae=1,wt=2,Kn={owned:null,cleanups:null,context:null,owner:null},jt={};var j=null;let yt=null,Ps=null,R=null,q=null,Y=null,Pt=0;function Ze(n,e){const t=R,s=j,r=n.length===0,i=e===void 0?s:e,a=r?Kn:{owned:null,cleanups:null,context:i?i.context:null,owner:i},o=r?n:()=>n(()=>ie(()=>nt(a)));j=a,R=null;try{return fe(o,!0)}finally{R=t,j=s}}function O(n,e){e=e?Object.assign({},mt,e):mt;const t={value:n,observers:null,observerSlots:null,comparator:e.equals||void 0},s=r=>(typeof r=="function"&&(r=r(t.value)),Yn(t,r));return[Qn.bind(t),s]}function dn(n,e,t){const s=Ot(n,e,!0,ae);Le(s)}function re(n,e,t){const s=Ot(n,e,!1,ae);Le(s)}function he(n,e,t){zn=Ns;const s=Ot(n,e,!1,ae),r=Ce&&tn(Ce);r&&(s.suspense=r),s.user=!0,Y?Y.push(s):Le(s)}function L(n,e,t){t=t?Object.assign({},mt,t):mt;const s=Ot(n,e,!0,0);return s.observers=null,s.observerSlots=null,s.comparator=t.equals||void 0,Le(s),Qn.bind(s)}function Os(n){return n&&typeof n=="object"&&"then"in n}function Ts(n,e,t){let s,r,i;s=!0,r=n,i={};let a=null,o=jt,l=null,c=!1,u="initialValue"in i,d=typeof s=="function"&&L(s);const h=new Set,[f,g]=(i.storage||O)(i.initialValue),[y,p]=O(void 0),[b,k]=O(void 0,{equals:!1}),[v,m]=O(u?"ready":"unresolved");E.context&&(l=E.getNextContextId(),i.ssrLoadFrom==="initial"?o=i.initialValue:E.load&&E.has(l)&&(o=E.load(l)));function w(P,I,C,M){return a===P&&(a=null,M!==void 0&&(u=!0),(P===o||I===o)&&i.onHydrated&&queueMicrotask(()=>i.onHydrated(M,{value:I})),o=jt,z(I,C)),I}function z(P,I){fe(()=>{I===void 0&&g(()=>P),m(I!==void 0?"errored":u?"ready":"unresolved"),p(I);for(const C of h.keys())C.decrement();h.clear()},!1)}function ee(){const P=Ce&&tn(Ce),I=f(),C=y();if(C!==void 0&&!a)throw C;return R&&!R.user&&P&&dn(()=>{b(),a&&(P.resolved&&yt||h.has(P)||(P.increment(),h.add(P)))}),I}function K(P=!0){if(P!==!1&&c)return;c=!1;const I=d?d():s;if(I==null||I===!1){w(a,ie(f));return}const C=o!==jt?o:ie(()=>r(I,{value:f(),refetching:P}));return Os(C)?(a=C,"value"in C?(C.status==="success"?w(a,C.value,void 0,I):w(a,void 0,Ft(C.value),I),C):(c=!0,queueMicrotask(()=>c=!1),fe(()=>{m(u?"refreshing":"pending"),k()},!1),C.then(M=>w(C,M,void 0,I),M=>w(C,void 0,Ft(M),I)))):(w(a,C,void 0,I),C)}return Object.defineProperties(ee,{state:{get:()=>v()},error:{get:()=>y()},loading:{get(){const P=v();return P==="pending"||P==="refreshing"}},latest:{get(){if(!u)return ee();const P=y();if(P&&!a)throw P;return f()}}}),d?dn(()=>K(!1)):K(!1),[ee,{refetch:K,mutate:g}]}function As(n){return fe(n,!1)}function ie(n){if(R===null)return n();const e=R;R=null;try{return n()}finally{R=e}}function Cs(n){he(()=>ie(n))}function en(n){return j===null||(j.cleanups===null?j.cleanups=[n]:j.cleanups.push(n)),n}function Mt(){return R}function js(){return j}function Is(n){Y.push.apply(Y,n),n.length=0}function Wn(n,e){const t=Symbol("context");return{id:t,Provider:Bs(t),defaultValue:n}}function tn(n){let e;return j&&j.context&&(e=j.context[n.id])!==void 0?e:n.defaultValue}function Rs(n){const e=L(n),t=L(()=>Ht(e()));return t.toArray=()=>{const s=t();return Array.isArray(s)?s:s!=null?[s]:[]},t}let Ce;function Ls(){return Ce||(Ce=Wn())}function Qn(){if(this.sources&&this.state)if(this.state===ae)Le(this);else{const n=q;q=null,fe(()=>vt(this),!1),q=n}if(R){const n=this.observers?this.observers.length:0;R.sources?(R.sources.push(this),R.sourceSlots.push(n)):(R.sources=[this],R.sourceSlots=[n]),this.observers?(this.observers.push(R),this.observerSlots.push(R.sources.length-1)):(this.observers=[R],this.observerSlots=[R.sources.length-1])}return this.value}function Yn(n,e,t){let s=n.value;return(!n.comparator||!n.comparator(s,e))&&(n.value=e,n.observers&&n.observers.length&&fe(()=>{for(let r=0;r<n.observers.length;r+=1){const i=n.observers[r],a=yt&&yt.running;a&&yt.disposed.has(i),(a?!i.tState:!i.state)&&(i.pure?q.push(i):Y.push(i),i.observers&&Zn(i)),a||(i.state=ae)}if(q.length>1e6)throw q=[],new Error},!1)),e}function Le(n){if(!n.fn)return;nt(n);const e=Pt;Ds(n,n.value,e)}function Ds(n,e,t){let s;const r=j,i=R;R=j=n;try{s=n.fn(e)}catch(a){return n.pure&&(n.state=ae,n.owned&&n.owned.forEach(nt),n.owned=null),n.updatedAt=t+1,es(a)}finally{R=i,j=r}(!n.updatedAt||n.updatedAt<=t)&&(n.updatedAt!=null&&"observers"in n?Yn(n,s):n.value=s,n.updatedAt=t)}function Ot(n,e,t,s=ae,r){const i={fn:n,state:s,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:j,context:j?j.context:null,pure:t};return j===null||j!==Kn&&(j.owned?j.owned.push(i):j.owned=[i]),i}function bt(n){if(n.state===0)return;if(n.state===wt)return vt(n);if(n.suspense&&ie(n.suspense.inFallback))return n.suspense.effects.push(n);const e=[n];for(;(n=n.owner)&&(!n.updatedAt||n.updatedAt<Pt);)n.state&&e.push(n);for(let t=e.length-1;t>=0;t--)if(n=e[t],n.state===ae)Le(n);else if(n.state===wt){const s=q;q=null,fe(()=>vt(n,e[0]),!1),q=s}}function fe(n,e){if(q)return n();let t=!1;e||(q=[]),Y?t=!0:Y=[],Pt++;try{const s=n();return Us(t),s}catch(s){t||(Y=null),q=null,es(s)}}function Us(n){if(q&&(Xn(q),q=null),n)return;const e=Y;Y=null,e.length&&fe(()=>zn(e),!1)}function Xn(n){for(let e=0;e<n.length;e++)bt(n[e])}function Ns(n){let e,t=0;for(e=0;e<n.length;e++){const s=n[e];s.user?n[t++]=s:bt(s)}if(E.context){if(E.count){E.effects||(E.effects=[]),E.effects.push(...n.slice(0,t));return}Qe()}for(E.effects&&(E.done||!E.count)&&(n=[...E.effects,...n],t+=E.effects.length,delete E.effects),e=0;e<t;e++)bt(n[e])}function vt(n,e){n.state=0;for(let t=0;t<n.sources.length;t+=1){const s=n.sources[t];if(s.sources){const r=s.state;r===ae?s!==e&&(!s.updatedAt||s.updatedAt<Pt)&&bt(s):r===wt&&vt(s,e)}}}function Zn(n){for(let e=0;e<n.observers.length;e+=1){const t=n.observers[e];t.state||(t.state=wt,t.pure?q.push(t):Y.push(t),t.observers&&Zn(t))}}function nt(n){let e;if(n.sources)for(;n.sources.length;){const t=n.sources.pop(),s=n.sourceSlots.pop(),r=t.observers;if(r&&r.length){const i=r.pop(),a=t.observerSlots.pop();s<r.length&&(i.sourceSlots[a]=s,r[s]=i,t.observerSlots[s]=a)}}if(n.tOwned){for(e=n.tOwned.length-1;e>=0;e--)nt(n.tOwned[e]);delete n.tOwned}if(n.owned){for(e=n.owned.length-1;e>=0;e--)nt(n.owned[e]);n.owned=null}if(n.cleanups){for(e=n.cleanups.length-1;e>=0;e--)n.cleanups[e]();n.cleanups=null}n.state=0}function Ft(n){return n instanceof Error?n:new Error(typeof n=="string"?n:"Unknown error",{cause:n})}function es(n,e=j){throw Ft(n)}function Ht(n){if(typeof n=="function"&&!n.length)return Ht(n());if(Array.isArray(n)){const e=[];for(let t=0;t<n.length;t++){const s=Ht(n[t]);Array.isArray(s)?e.push.apply(e,s):e.push(s)}return e}return n}function Bs(n,e){return function(s){let r;return re(()=>r=ie(()=>(j.context={...j.context,[n]:s.value},Rs(()=>s.children))),void 0),r}}const qs=Symbol("fallback");function hn(n){for(let e=0;e<n.length;e++)n[e]()}function Ms(n,e,t={}){let s=[],r=[],i=[],a=0,o=e.length>1?[]:null;return en(()=>hn(i)),()=>{let l=n()||[],c=l.length,u,d;return l[qt],ie(()=>{let f,g,y,p,b,k,v,m,w;if(c===0)a!==0&&(hn(i),i=[],s=[],r=[],a=0,o&&(o=[])),t.fallback&&(s=[qs],r[0]=Ze(z=>(i[0]=z,t.fallback())),a=1);else if(a===0){for(r=new Array(c),d=0;d<c;d++)s[d]=l[d],r[d]=Ze(h);a=c}else{for(y=new Array(c),p=new Array(c),o&&(b=new Array(c)),k=0,v=Math.min(a,c);k<v&&s[k]===l[k];k++);for(v=a-1,m=c-1;v>=k&&m>=k&&s[v]===l[m];v--,m--)y[m]=r[v],p[m]=i[v],o&&(b[m]=o[v]);for(f=new Map,g=new Array(m+1),d=m;d>=k;d--)w=l[d],u=f.get(w),g[d]=u===void 0?-1:u,f.set(w,d);for(u=k;u<=v;u++)w=s[u],d=f.get(w),d!==void 0&&d!==-1?(y[d]=r[u],p[d]=i[u],o&&(b[d]=o[u]),d=g[d],f.set(w,d)):i[u]();for(d=k;d<c;d++)d in y?(r[d]=y[d],i[d]=p[d],o&&(o[d]=b[d],o[d](d))):r[d]=Ze(h);r=r.slice(0,a=c),s=l.slice(0)}return r});function h(f){if(i[d]=f,o){const[g,y]=O(d);return o[d]=y,e(l[d],g)}return e(l[d])}}}function B(n,e){return ie(()=>n(e||{}))}function dt(){return!0}const Jt={get(n,e,t){return e===X?t:n.get(e)},has(n,e){return e===X?!0:n.has(e)},set:dt,deleteProperty:dt,getOwnPropertyDescriptor(n,e){return{configurable:!0,enumerable:!0,get(){return n.get(e)},set:dt,deleteProperty:dt}},ownKeys(n){return n.keys()}};function It(n){return(n=typeof n=="function"?n():n)?n:{}}function Fs(){for(let n=0,e=this.length;n<e;++n){const t=this[n]();if(t!==void 0)return t}}function fn(...n){let e=!1;for(let a=0;a<n.length;a++){const o=n[a];e=e||!!o&&X in o,n[a]=typeof o=="function"?(e=!0,L(o)):o}if(Gn&&e)return new Proxy({get(a){for(let o=n.length-1;o>=0;o--){const l=It(n[o])[a];if(l!==void 0)return l}},has(a){for(let o=n.length-1;o>=0;o--)if(a in It(n[o]))return!0;return!1},keys(){const a=[];for(let o=0;o<n.length;o++)a.push(...Object.keys(It(n[o])));return[...new Set(a)]}},Jt);const t={},s=Object.create(null);for(let a=n.length-1;a>=0;a--){const o=n[a];if(!o)continue;const l=Object.getOwnPropertyNames(o);for(let c=l.length-1;c>=0;c--){const u=l[c];if(u==="__proto__"||u==="constructor")continue;const d=Object.getOwnPropertyDescriptor(o,u);if(!s[u])s[u]=d.get?{enumerable:!0,configurable:!0,get:Fs.bind(t[u]=[d.get.bind(o)])}:d.value!==void 0?d:void 0;else{const h=t[u];h&&(d.get?h.push(d.get.bind(o)):d.value!==void 0&&h.push(()=>d.value))}}}const r={},i=Object.keys(s);for(let a=i.length-1;a>=0;a--){const o=i[a],l=s[o];l&&l.get?Object.defineProperty(r,o,l):r[o]=l?l.value:void 0}return r}function Hs(n,...e){if(Gn&&X in n){const r=new Set(e.length>1?e.flat():e[0]),i=e.map(a=>new Proxy({get(o){return a.includes(o)?n[o]:void 0},has(o){return a.includes(o)&&o in n},keys(){return a.filter(o=>o in n)}},Jt));return i.push(new Proxy({get(a){return r.has(a)?void 0:n[a]},has(a){return r.has(a)?!1:a in n},keys(){return Object.keys(n).filter(a=>!r.has(a))}},Jt)),i}const t={},s=e.map(()=>({}));for(const r of Object.getOwnPropertyNames(n)){const i=Object.getOwnPropertyDescriptor(n,r),a=!i.get&&!i.set&&i.enumerable&&i.writable&&i.configurable;let o=!1,l=0;for(const c of e)c.includes(r)&&(o=!0,a?s[l][r]=i.value:Object.defineProperty(s[l],r,i)),++l;o||(a?t[r]=i.value:Object.defineProperty(t,r,i))}return[...s,t]}function Tt(n){const e="fallback"in n&&{fallback:()=>n.fallback};return L(Ms(()=>n.each,n.children,e||void 0))}const Js=Wn();function Vs(n){let e=0,t,s,r,i,a;const[o,l]=O(!1),c=Ls(),u={increment:()=>{++e===1&&l(!0)},decrement:()=>{--e===0&&l(!1)},inFallback:o,effects:[],resolved:!1},d=js();if(E.context&&E.load){const g=E.getContextId();let y=E.load(g);if(y&&(typeof y!="object"||y.status!=="success"?r=y:E.gather(g)),r&&r!=="$$f"){const[p,b]=O(void 0,{equals:!1});i=p,r.then(()=>{if(E.done)return b();E.gather(g),Qe(s),b(),Qe()},k=>{a=k,b()})}}const h=tn(Js);h&&(t=h.register(u.inFallback));let f;return en(()=>f&&f()),B(c.Provider,{value:u,get children(){return L(()=>{if(a)throw a;if(s=E.context,i)return i(),i=void 0;s&&r==="$$f"&&Qe();const g=L(()=>n.children);return L(y=>{const p=u.inFallback(),{showContent:b=!0,showFallback:k=!0}=t?t():{};if((!p||r&&r!=="$$f")&&b)return u.resolved=!0,f&&f(),f=s=r=void 0,Is(u.effects),g();if(k)return f?y:Ze(v=>(f=v,s&&(Qe({id:s.id+"F",count:0}),s=void 0),n.fallback),d)})})}})}const Gs=new Set(["innerHTML","textContent","innerText","children"]),zs=Object.assign(Object.create(null),{className:"class",htmlFor:"for"}),Ks=new Set(["beforeinput","click","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"]),Ws={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"};function Qs(n,e,t){let s=t.length,r=e.length,i=s,a=0,o=0,l=e[r-1].nextSibling,c=null;for(;a<r||o<i;){if(e[a]===t[o]){a++,o++;continue}for(;e[r-1]===t[i-1];)r--,i--;if(r===a){const u=i<s?o?t[o-1].nextSibling:t[i-o]:l;for(;o<i;)n.insertBefore(t[o++],u)}else if(i===o)for(;a<r;)(!c||!c.has(e[a]))&&e[a].remove(),a++;else if(e[a]===t[i-1]&&t[o]===e[r-1]){const u=e[--r].nextSibling;n.insertBefore(t[o++],e[a++].nextSibling),n.insertBefore(t[--i],u),e[r]=t[i]}else{if(!c){c=new Map;let d=o;for(;d<i;)c.set(t[d],d++)}const u=c.get(e[a]);if(u!=null)if(o<u&&u<i){let d=a,h=1,f;for(;++d<r&&d<i&&!((f=c.get(e[d]))==null||f!==u+h);)h++;if(h>u-o){const g=e[a];for(;o<u;)n.insertBefore(t[o++],g)}else n.replaceChild(t[o++],e[a++])}else a++;else e[a++].remove()}}}const gn="_$DX_DELEGATE";function Ys(n,e,t,s={}){let r;return Ze(i=>{r=i,e===document?n():$(e,n(),e.firstChild?null:void 0,t)},s.owner),()=>{r(),e.textContent=""}}function T(n,e,t){let s;const r=()=>{const a=document.createElement("template");return a.innerHTML=n,a.content.firstChild},i=()=>(s||(s=r())).cloneNode(!0);return i.cloneNode=i,i}function ot(n,e=window.document){const t=e[gn]||(e[gn]=new Set);for(let s=0,r=n.length;s<r;s++){const i=n[s];t.has(i)||(t.add(i),e.addEventListener(i,ir))}}function st(n,e,t){De(n)||(t==null?n.removeAttribute(e):n.setAttribute(e,t))}function Xs(n,e,t,s){De(n)||(s==null?n.removeAttributeNS(e,t):n.setAttributeNS(e,t,s))}function Zs(n,e,t){De(n)||(t?n.setAttribute(e,""):n.removeAttribute(e))}function ts(n,e){De(n)||(e==null?n.removeAttribute("class"):n.className=e)}function At(n,e,t,s){if(s)Array.isArray(t)?(n[`$$${e}`]=t[0],n[`$$${e}Data`]=t[1]):n[`$$${e}`]=t;else if(Array.isArray(t)){const r=t[0];n.addEventListener(e,t[0]=i=>r.call(n,t[1],i))}else n.addEventListener(e,t,typeof t!="function"&&t)}function er(n,e,t={}){const s=Object.keys(e||{}),r=Object.keys(t);let i,a;for(i=0,a=r.length;i<a;i++){const o=r[i];!o||o==="undefined"||e[o]||(pn(n,o,!1),delete t[o])}for(i=0,a=s.length;i<a;i++){const o=s[i],l=!!e[o];!o||o==="undefined"||t[o]===l||!l||(pn(n,o,!0),t[o]=l)}return t}function tr(n,e,t){if(!e)return t?st(n,"style"):e;const s=n.style;if(typeof e=="string")return s.cssText=e;typeof t=="string"&&(s.cssText=t=void 0),t||(t={}),e||(e={});let r,i;for(i in t)e[i]==null&&s.removeProperty(i),delete t[i];for(i in e)r=e[i],r!==t[i]&&(s.setProperty(i,r),t[i]=r);return t}function nr(n,e={},t,s){const r={};return re(()=>typeof e.ref=="function"&&je(e.ref,n)),re(()=>sr(n,e,t,!0,r,!0)),r}function je(n,e,t){return ie(()=>n(e,t))}function $(n,e,t,s){if(t!==void 0&&!s&&(s=[]),typeof e!="function")return kt(n,e,s,t);re(r=>kt(n,e(),r,t),s)}function sr(n,e,t,s,r={},i=!1){e||(e={});for(const a in r)if(!(a in e)){if(a==="children")continue;r[a]=_n(n,a,null,r[a],t,i,e)}for(const a in e){if(a==="children")continue;const o=e[a];r[a]=_n(n,a,o,r[a],t,i,e)}}function De(n){return!!E.context&&!E.done&&(!n||n.isConnected)}function rr(n){return n.toLowerCase().replace(/-([a-z])/g,(e,t)=>t.toUpperCase())}function pn(n,e,t){const s=e.trim().split(/\s+/);for(let r=0,i=s.length;r<i;r++)n.classList.toggle(s[r],t)}function _n(n,e,t,s,r,i,a){let o,l,c,u;if(e==="style")return tr(n,t,s);if(e==="classList")return er(n,t,s);if(t===s)return s;if(e==="ref")i||t(n);else if(e.slice(0,3)==="on:"){const d=e.slice(3);s&&n.removeEventListener(d,s,typeof s!="function"&&s),t&&n.addEventListener(d,t,typeof t!="function"&&t)}else if(e.slice(0,10)==="oncapture:"){const d=e.slice(10);s&&n.removeEventListener(d,s,!0),t&&n.addEventListener(d,t,!0)}else if(e.slice(0,2)==="on"){const d=e.slice(2).toLowerCase(),h=Ks.has(d);if(!h&&s){const f=Array.isArray(s)?s[0]:s;n.removeEventListener(d,f)}(h||t)&&(At(n,d,t,h),h&&ot([d]))}else if(e.slice(0,5)==="attr:")st(n,e.slice(5),t);else if(e.slice(0,5)==="bool:")Zs(n,e.slice(5),t);else if((u=e.slice(0,5)==="prop:")||(c=Gs.has(e))||(o=n.nodeName.includes("-")||"is"in a)){if(u)e=e.slice(5),l=!0;else if(De(n))return t;e==="class"||e==="className"?ts(n,t):o&&!l&&!c?n[rr(e)]=t:n[e]=t}else{const d=e.indexOf(":")>-1&&Ws[e.split(":")[0]];d?Xs(n,d,e,t):st(n,zs[e]||e,t)}return t}function ir(n){if(E.registry&&E.events&&E.events.find(([l,c])=>c===n))return;let e=n.target;const t=`$$${n.type}`,s=n.target,r=n.currentTarget,i=l=>Object.defineProperty(n,"target",{configurable:!0,value:l}),a=()=>{const l=e[t];if(l&&!e.disabled){const c=e[`${t}Data`];if(c!==void 0?l.call(e,c,n):l.call(e,n),n.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(n.target)&&i(e.host),!0},o=()=>{for(;a()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(n,"currentTarget",{configurable:!0,get(){return e||document}}),E.registry&&!E.done&&(E.done=_$HY.done=!0),n.composedPath){const l=n.composedPath();i(l[0]);for(let c=0;c<l.length-2&&(e=l[c],!!a());c++){if(e._$host){e=e._$host,o();break}if(e.parentNode===r)break}}else o();i(s)}function kt(n,e,t,s,r){const i=De(n);if(i){!t&&(t=[...n.childNodes]);let l=[];for(let c=0;c<t.length;c++){const u=t[c];u.nodeType===8&&u.data.slice(0,2)==="!$"?u.remove():l.push(u)}t=l}for(;typeof t=="function";)t=t();if(e===t)return t;const a=typeof e,o=s!==void 0;if(n=o&&t[0]&&t[0].parentNode||n,a==="string"||a==="number"){if(i||a==="number"&&(e=e.toString(),e===t))return t;if(o){let l=t[0];l&&l.nodeType===3?l.data!==e&&(l.data=e):l=document.createTextNode(e),t=$e(n,t,s,l)}else t!==""&&typeof t=="string"?t=n.firstChild.data=e:t=n.textContent=e}else if(e==null||a==="boolean"){if(i)return t;t=$e(n,t,s)}else{if(a==="function")return re(()=>{let l=e();for(;typeof l=="function";)l=l();t=kt(n,l,t,s)}),()=>t;if(Array.isArray(e)){const l=[],c=t&&Array.isArray(t);if(Vt(l,e,t,r))return re(()=>t=kt(n,l,t,s,!0)),()=>t;if(i){if(!l.length)return t;if(s===void 0)return t=[...n.childNodes];let u=l[0];if(u.parentNode!==n)return t;const d=[u];for(;(u=u.nextSibling)!==s;)d.push(u);return t=d}if(l.length===0){if(t=$e(n,t,s),o)return t}else c?t.length===0?yn(n,l,s):Qs(n,t,l):(t&&$e(n),yn(n,l));t=l}else if(e.nodeType){if(i&&e.parentNode)return t=o?[e]:e;if(Array.isArray(t)){if(o)return t=$e(n,t,s,e);$e(n,t,null,e)}else t==null||t===""||!n.firstChild?n.appendChild(e):n.replaceChild(e,n.firstChild);t=e}}return t}function Vt(n,e,t,s){let r=!1;for(let i=0,a=e.length;i<a;i++){let o=e[i],l=t&&t[n.length],c;if(!(o==null||o===!0||o===!1))if((c=typeof o)=="object"&&o.nodeType)n.push(o);else if(Array.isArray(o))r=Vt(n,o,l)||r;else if(c==="function")if(s){for(;typeof o=="function";)o=o();r=Vt(n,Array.isArray(o)?o:[o],Array.isArray(l)?l:[l])||r}else n.push(o),r=!0;else{const u=String(o);l&&l.nodeType===3&&l.data===u?n.push(l):n.push(document.createTextNode(u))}}return r}function yn(n,e,t=null){for(let s=0,r=e.length;s<r;s++)n.insertBefore(e[s],t)}function $e(n,e,t,s){if(t===void 0)return n.textContent="";const r=s||document.createTextNode("");if(e.length){let i=!1;for(let a=e.length-1;a>=0;a--){const o=e[a];if(r!==o){const l=o.parentNode===n;!i&&!a?l?n.replaceChild(r,o):n.insertBefore(r,t):l&&o.remove()}else i=!0}}else n.insertBefore(r,t);return[r]}const ar=!1,or="modulepreload",lr=function(n){return"/"+n},mn={},Ie=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=Promise.allSettled(t.map(l=>{if(l=lr(l),l in mn)return;mn[l]=!0;const c=l.endsWith(".css"),u=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":or,c||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),c)return new Promise((h,f)=>{d.addEventListener("load",h),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return r.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})},ur=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ie(async()=>{const{default:s}=await Promise.resolve().then(()=>Ue);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)};class nn extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class cr extends nn{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class dr extends nn{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class hr extends nn{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Gt;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Gt||(Gt={}));var fr=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(d){a(d)}}function l(u){try{c(s.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((s=s.apply(n,e||[])).next())})};class gr{constructor(e,{headers:t={},customFetch:s,region:r=Gt.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=ur(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return fr(this,void 0,void 0,function*(){try{const{headers:r,method:i,body:a}=t;let o={},{region:l}=t;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let c;a&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=a):typeof a=="string"?(o["Content-Type"]="text/plain",c=a):typeof FormData<"u"&&a instanceof FormData?c=a:(o["Content-Type"]="application/json",c=JSON.stringify(a)));const u=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),r),body:c}).catch(g=>{throw new cr(g)}),d=u.headers.get("x-relay-error");if(d&&d==="true")throw new dr(u);if(!u.ok)throw new hr(u);let h=((s=u.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),f;return h==="application/json"?f=yield u.json():h==="application/octet-stream"?f=yield u.blob():h==="text/event-stream"?f=u:h==="multipart/form-data"?f=yield u.formData():f=yield u.text(),{data:f,error:null}}catch(r){return{data:null,error:r}}})}}function pr(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function _r(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var r=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,r.get?r:{enumerable:!0,get:function(){return n[s]}})}),t}var U={},Fe={},He={},Je={},Ve={},Ge={},yr=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Re=yr();const mr=Re.fetch,ns=Re.fetch.bind(Re),ss=Re.Headers,wr=Re.Request,br=Re.Response,Ue=Object.freeze(Object.defineProperty({__proto__:null,Headers:ss,Request:wr,Response:br,default:ns,fetch:mr},Symbol.toStringTag,{value:"Module"})),vr=_r(Ue);var ht={},wn;function rs(){if(wn)return ht;wn=1,Object.defineProperty(ht,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return ht.default=n,ht}var bn;function is(){if(bn)return Ge;bn=1;var n=Ge.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ge,"__esModule",{value:!0});const e=n(vr),t=n(rs());class s{constructor(i){this.shouldThrowOnError=!1,this.method=i.method,this.url=i.url,this.headers=i.headers,this.schema=i.schema,this.body=i.body,this.shouldThrowOnError=i.shouldThrowOnError,this.signal=i.signal,this.isMaybeSingle=i.isMaybeSingle,i.fetch?this.fetch=i.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(i,a){return this.headers=Object.assign({},this.headers),this.headers[i]=a,this}then(i,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var u,d,h;let f=null,g=null,y=null,p=c.status,b=c.statusText;if(c.ok){if(this.method!=="HEAD"){const w=await c.text();w===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?g=w:g=JSON.parse(w))}const v=(u=this.headers.Prefer)===null||u===void 0?void 0:u.match(/count=(exact|planned|estimated)/),m=(d=c.headers.get("content-range"))===null||d===void 0?void 0:d.split("/");v&&m&&m.length>1&&(y=parseInt(m[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(f={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,y=null,p=406,b="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const v=await c.text();try{f=JSON.parse(v),Array.isArray(f)&&c.status===404&&(g=[],f=null,p=200,b="OK")}catch{c.status===404&&v===""?(p=204,b="No Content"):f={message:v}}if(f&&this.isMaybeSingle&&(!((h=f==null?void 0:f.details)===null||h===void 0)&&h.includes("0 rows"))&&(f=null,p=200,b="OK"),f&&this.shouldThrowOnError)throw new t.default(f)}return{error:f,data:g,count:y,status:p,statusText:b}});return this.shouldThrowOnError||(l=l.catch(c=>{var u,d,h;return{error:{message:`${(u=c==null?void 0:c.name)!==null&&u!==void 0?u:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(d=c==null?void 0:c.stack)!==null&&d!==void 0?d:""}`,hint:"",code:`${(h=c==null?void 0:c.code)!==null&&h!==void 0?h:""}`},data:null,count:null,status:0,statusText:""}})),l.then(i,a)}}return Ge.default=s,Ge}var vn;function as(){if(vn)return Ve;vn=1;var n=Ve.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ve,"__esModule",{value:!0});const e=n(is());class t extends e.default{select(r){let i=!1;const a=(r??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(r,{ascending:i=!0,nullsFirst:a,foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.order`:"order",u=this.url.searchParams.get(c);return this.url.searchParams.set(c,`${u?`${u},`:""}${r}.${i?"asc":"desc"}${a===void 0?"":a?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:i,referencedTable:a=i}={}){const o=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(o,`${r}`),this}range(r,i,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"offset":`${o}.offset`,c=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${r}`),this.url.searchParams.set(c,`${i-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:r=!1,verbose:i=!1,settings:a=!1,buffers:o=!1,wal:l=!1,format:c="text"}={}){var u;const d=[r?"analyze":null,i?"verbose":null,a?"settings":null,o?"buffers":null,l?"wal":null].filter(Boolean).join("|"),h=(u=this.headers.Accept)!==null&&u!==void 0?u:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${c}; for="${h}"; options=${d};`,c==="json"?this:this}rollback(){var r;return((r=this.headers.Prefer)!==null&&r!==void 0?r:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Ve.default=t,Ve}var kn;function sn(){if(kn)return Je;kn=1;var n=Je.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Je,"__esModule",{value:!0});const e=n(as());class t extends e.default{eq(r,i){return this.url.searchParams.append(r,`eq.${i}`),this}neq(r,i){return this.url.searchParams.append(r,`neq.${i}`),this}gt(r,i){return this.url.searchParams.append(r,`gt.${i}`),this}gte(r,i){return this.url.searchParams.append(r,`gte.${i}`),this}lt(r,i){return this.url.searchParams.append(r,`lt.${i}`),this}lte(r,i){return this.url.searchParams.append(r,`lte.${i}`),this}like(r,i){return this.url.searchParams.append(r,`like.${i}`),this}likeAllOf(r,i){return this.url.searchParams.append(r,`like(all).{${i.join(",")}}`),this}likeAnyOf(r,i){return this.url.searchParams.append(r,`like(any).{${i.join(",")}}`),this}ilike(r,i){return this.url.searchParams.append(r,`ilike.${i}`),this}ilikeAllOf(r,i){return this.url.searchParams.append(r,`ilike(all).{${i.join(",")}}`),this}ilikeAnyOf(r,i){return this.url.searchParams.append(r,`ilike(any).{${i.join(",")}}`),this}is(r,i){return this.url.searchParams.append(r,`is.${i}`),this}in(r,i){const a=Array.from(new Set(i)).map(o=>typeof o=="string"&&new RegExp("[,()]").test(o)?`"${o}"`:`${o}`).join(",");return this.url.searchParams.append(r,`in.(${a})`),this}contains(r,i){return typeof i=="string"?this.url.searchParams.append(r,`cs.${i}`):Array.isArray(i)?this.url.searchParams.append(r,`cs.{${i.join(",")}}`):this.url.searchParams.append(r,`cs.${JSON.stringify(i)}`),this}containedBy(r,i){return typeof i=="string"?this.url.searchParams.append(r,`cd.${i}`):Array.isArray(i)?this.url.searchParams.append(r,`cd.{${i.join(",")}}`):this.url.searchParams.append(r,`cd.${JSON.stringify(i)}`),this}rangeGt(r,i){return this.url.searchParams.append(r,`sr.${i}`),this}rangeGte(r,i){return this.url.searchParams.append(r,`nxl.${i}`),this}rangeLt(r,i){return this.url.searchParams.append(r,`sl.${i}`),this}rangeLte(r,i){return this.url.searchParams.append(r,`nxr.${i}`),this}rangeAdjacent(r,i){return this.url.searchParams.append(r,`adj.${i}`),this}overlaps(r,i){return typeof i=="string"?this.url.searchParams.append(r,`ov.${i}`):this.url.searchParams.append(r,`ov.{${i.join(",")}}`),this}textSearch(r,i,{config:a,type:o}={}){let l="";o==="plain"?l="pl":o==="phrase"?l="ph":o==="websearch"&&(l="w");const c=a===void 0?"":`(${a})`;return this.url.searchParams.append(r,`${l}fts${c}.${i}`),this}match(r){return Object.entries(r).forEach(([i,a])=>{this.url.searchParams.append(i,`eq.${a}`)}),this}not(r,i,a){return this.url.searchParams.append(r,`not.${i}.${a}`),this}or(r,{foreignTable:i,referencedTable:a=i}={}){const o=a?`${a}.or`:"or";return this.url.searchParams.append(o,`(${r})`),this}filter(r,i,a){return this.url.searchParams.append(r,`${i}.${a}`),this}}return Je.default=t,Je}var Sn;function os(){if(Sn)return He;Sn=1;var n=He.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(He,"__esModule",{value:!0});const e=n(sn());class t{constructor(r,{headers:i={},schema:a,fetch:o}){this.url=r,this.headers=i,this.schema=a,this.fetch=o}select(r,{head:i=!1,count:a}={}){const o=i?"HEAD":"GET";let l=!1;const c=(r??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),a&&(this.headers.Prefer=`count=${a}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(r,{count:i,defaultToNull:a=!0}={}){const o="POST",l=[];if(this.headers.Prefer&&l.push(this.headers.Prefer),i&&l.push(`count=${i}`),a||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(r)){const c=r.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}upsert(r,{onConflict:i,ignoreDuplicates:a=!1,count:o,defaultToNull:l=!0}={}){const c="POST",u=[`resolution=${a?"ignore":"merge"}-duplicates`];if(i!==void 0&&this.url.searchParams.set("on_conflict",i),this.headers.Prefer&&u.push(this.headers.Prefer),o&&u.push(`count=${o}`),l||u.push("missing=default"),this.headers.Prefer=u.join(","),Array.isArray(r)){const d=r.reduce((h,f)=>h.concat(Object.keys(f)),[]);if(d.length>0){const h=[...new Set(d)].map(f=>`"${f}"`);this.url.searchParams.set("columns",h.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}update(r,{count:i}={}){const a="PATCH",o=[];return this.headers.Prefer&&o.push(this.headers.Prefer),i&&o.push(`count=${i}`),this.headers.Prefer=o.join(","),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:this.fetch,allowEmpty:!1})}delete({count:r}={}){const i="DELETE",a=[];return r&&a.push(`count=${r}`),this.headers.Prefer&&a.unshift(this.headers.Prefer),this.headers.Prefer=a.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return He.default=t,He}var ze={},Ke={},$n;function kr(){return $n||($n=1,Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.version=void 0,Ke.version="0.0.0-automated"),Ke}var xn;function Sr(){if(xn)return ze;xn=1,Object.defineProperty(ze,"__esModule",{value:!0}),ze.DEFAULT_HEADERS=void 0;const n=kr();return ze.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`},ze}var En;function $r(){if(En)return Fe;En=1;var n=Fe.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(Fe,"__esModule",{value:!0});const e=n(os()),t=n(sn()),s=Sr();class r{constructor(a,{headers:o={},schema:l,fetch:c}={}){this.url=a,this.headers=Object.assign(Object.assign({},s.DEFAULT_HEADERS),o),this.schemaName=l,this.fetch=c}from(a){const o=new URL(`${this.url}/${a}`);return new e.default(o,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new r(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:l=!1,get:c=!1,count:u}={}){let d;const h=new URL(`${this.url}/rpc/${a}`);let f;l||c?(d=l?"HEAD":"GET",Object.entries(o).filter(([y,p])=>p!==void 0).map(([y,p])=>[y,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([y,p])=>{h.searchParams.append(y,p)})):(d="POST",f=o);const g=Object.assign({},this.headers);return u&&(g.Prefer=`count=${u}`),new t.default({method:d,url:h,headers:g,schema:this.schemaName,body:f,fetch:this.fetch,allowEmpty:!1})}}return Fe.default=r,Fe}var Pn;function xr(){if(Pn)return U;Pn=1;var n=U.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(U,"__esModule",{value:!0}),U.PostgrestError=U.PostgrestBuilder=U.PostgrestTransformBuilder=U.PostgrestFilterBuilder=U.PostgrestQueryBuilder=U.PostgrestClient=void 0;const e=n($r());U.PostgrestClient=e.default;const t=n(os());U.PostgrestQueryBuilder=t.default;const s=n(sn());U.PostgrestFilterBuilder=s.default;const r=n(as());U.PostgrestTransformBuilder=r.default;const i=n(is());U.PostgrestBuilder=i.default;const a=n(rs());return U.PostgrestError=a.default,U.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:s.default,PostgrestTransformBuilder:r.default,PostgrestBuilder:i.default,PostgrestError:a.default},U}var Er=xr();const Pr=pr(Er),{PostgrestClient:Or,PostgrestQueryBuilder:oo,PostgrestFilterBuilder:lo,PostgrestTransformBuilder:uo,PostgrestBuilder:co,PostgrestError:ho}=Pr,Tr="2.11.2",Ar={"X-Client-Info":`realtime-js/${Tr}`},Cr="1.0.0",ls=1e4,jr=1e3;var Oe;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Oe||(Oe={}));var V;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(V||(V={}));var Q;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Q||(Q={}));var zt;(function(n){n.websocket="websocket"})(zt||(zt={}));var me;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(me||(me={}));class Ir{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const r=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=s.decode(e.slice(a,a+r));a=a+r;const l=s.decode(e.slice(a,a+i));a=a+i;const c=JSON.parse(s.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class us{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var A;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(A||(A={}));const On=(n,e,t={})=>{var s;const r=(s=t.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(e).reduce((i,a)=>(i[a]=Rr(a,n,e,r),i),{})},Rr=(n,e,t,s)=>{const r=e.find(o=>o.name===n),i=r==null?void 0:r.type,a=t[n];return i&&!s.includes(i)?cs(i,a):Kt(a)},cs=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return Nr(e,t)}switch(n){case A.bool:return Lr(e);case A.float4:case A.float8:case A.int2:case A.int4:case A.int8:case A.numeric:case A.oid:return Dr(e);case A.json:case A.jsonb:return Ur(e);case A.timestamp:return Br(e);case A.abstime:case A.date:case A.daterange:case A.int4range:case A.int8range:case A.money:case A.reltime:case A.text:case A.time:case A.timestamptz:case A.timetz:case A.tsrange:case A.tstzrange:return Kt(e);default:return Kt(e)}},Kt=n=>n,Lr=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Dr=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},Ur=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},Nr=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,s=n[t];if(n[0]==="{"&&s==="}"){let i;const a=n.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>cs(e,o))}return n},Br=n=>typeof n=="string"?n.replace(" ","T"):n,ds=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Rt{constructor(e,t,s={},r=ls){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Tn;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Tn||(Tn={}));class et{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=et.syncState(this.state,r,i,a),this.pendingDiffs.forEach(l=>{this.state=et.syncDiff(this.state,l,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(s.diff,{},r=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=et.syncDiff(this.state,r,i,a),o())}),this.onJoin((r,i,a)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:i,newPresences:a})}),this.onLeave((r,i,a)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,r){const i=this.cloneDeep(e),a=this.transformState(t),o={},l={};return this.map(i,(c,u)=>{a[c]||(l[c]=u)}),this.map(a,(c,u)=>{const d=i[c];if(d){const h=u.map(p=>p.presence_ref),f=d.map(p=>p.presence_ref),g=u.filter(p=>f.indexOf(p.presence_ref)<0),y=d.filter(p=>h.indexOf(p.presence_ref)<0);g.length>0&&(o[c]=g),y.length>0&&(l[c]=y)}else o[c]=u}),this.syncDiff(i,{joins:o,leaves:l},s,r)}static syncDiff(e,t,s,r){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(i,(o,l)=>{var c;const u=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(l),u.length>0){const d=e[o].map(f=>f.presence_ref),h=u.filter(f=>d.indexOf(f.presence_ref)<0);e[o].unshift(...h)}s(o,u,l)}),this.map(a,(o,l)=>{let c=e[o];if(!c)return;const u=l.map(d=>d.presence_ref);c=c.filter(d=>u.indexOf(d.presence_ref)<0),e[o]=c,r(o,c,l),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const r=e[s];return"metas"in r?t[s]=r.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[s]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var An;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(An||(An={}));var Cn;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Cn||(Cn={}));var ne;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(ne||(ne={}));class rn{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=V.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Rt(this,Q.join,this.params,this.timeout),this.rejoinTimer=new us(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=V.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(r=>r.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=V.closed,this.socket._remove(this)}),this._onError(r=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,r),this.state=V.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=V.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Q.reply,{},(r,i)=>{this._trigger(this._replyEventName(i),r)}),this.presence=new et(this),this.broadcastEndpointURL=ds(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:a,private:o}}=this.params;this._onError(u=>e==null?void 0:e(ne.CHANNEL_ERROR,u)),this._onClose(()=>e==null?void 0:e(ne.CLOSED));const l={},c={broadcast:i,presence:a,postgres_changes:(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(u=>u.filter))!==null&&r!==void 0?r:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:u})=>{var d;if(this.socket.setAuth(),u===void 0){e==null||e(ne.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,f=(d=h==null?void 0:h.length)!==null&&d!==void 0?d:0,g=[];for(let y=0;y<f;y++){const p=h[y],{filter:{event:b,schema:k,table:v,filter:m}}=p,w=u&&u[y];if(w&&w.event===b&&w.schema===k&&w.table===v&&w.filter===m)g.push(Object.assign(Object.assign({},p),{id:w.id}));else{this.unsubscribe(),e==null||e(ne.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(ne.SUBSCRIBED);return}}).receive("error",u=>{e==null||e(ne.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(u).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(ne.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,r;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((r=c.body)===null||r===void 0?void 0:r.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,l;const c=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((l=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&i("ok"),c.receive("ok",()=>i("ok")),c.receive("error",()=>i("error")),c.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=V.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Q.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(s=>{const r=new Rt(this,Q.leave,{},e);r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})})}async _fetchWithTimeout(e,t,s){const r=new AbortController,i=setTimeout(()=>r.abort(),s),a=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(i),a}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Rt(this,e,t,s);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,i;const a=e.toLocaleLowerCase(),{close:o,error:l,leave:c,join:u}=Q;if(s&&[o,l,c,u].indexOf(a)>=0&&s!==this._joinRef())return;let h=this._onMessage(a,t,s);if(t&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(f=>{var g,y,p;return((g=f.filter)===null||g===void 0?void 0:g.event)==="*"||((p=(y=f.filter)===null||y===void 0?void 0:y.event)===null||p===void 0?void 0:p.toLocaleLowerCase())===a}).map(f=>f.callback(h,s)):(i=this.bindings[a])===null||i===void 0||i.filter(f=>{var g,y,p,b,k,v;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in f){const m=f.id,w=(g=f.filter)===null||g===void 0?void 0:g.event;return m&&((y=t.ids)===null||y===void 0?void 0:y.includes(m))&&(w==="*"||(w==null?void 0:w.toLocaleLowerCase())===((p=t.data)===null||p===void 0?void 0:p.type.toLocaleLowerCase()))}else{const m=(k=(b=f==null?void 0:f.filter)===null||b===void 0?void 0:b.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return m==="*"||m===((v=t==null?void 0:t.event)===null||v===void 0?void 0:v.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===a}).map(f=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:y,table:p,commit_timestamp:b,type:k,errors:v}=g;h=Object.assign(Object.assign({},{schema:y,table:p,commit_timestamp:b,eventType:k,new:{},old:{},errors:v}),this._getPayloadRecords(g))}f.callback(h,s)})}_isClosed(){return this.state===V.closed}_isJoined(){return this.state===V.joined}_isJoining(){return this.state===V.joining}_isLeaving(){return this.state===V.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const r=e.toLocaleLowerCase(),i={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter(r=>{var i;return!(((i=r.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&rn.isEqual(r.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Q.close,{},e)}_onError(e){this._on(Q.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=V.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=On(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=On(e.columns,e.old_record)),t}}const qr=()=>{},Mr=typeof WebSocket<"u",Fr=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Hr{constructor(e,t){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=Ar,this.params={},this.timeout=ls,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=qr,this.conn=null,this.sendBuffer=[],this.serializer=new Ir,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>Ie(async()=>{const{default:l}=await Promise.resolve().then(()=>Ue);return{default:l}},void 0).then(({default:l})=>l(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${e}/${zt.websocket}`,this.httpEndpoint=ds(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const r=(s=t==null?void 0:t.params)===null||s===void 0?void 0:s.apikey;if(r&&(this.accessTokenValue=r,this.apiKey=r),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,a)=>a(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new us(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(Mr){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new Jr(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Ie(async()=>{const{default:e}=await import("./browser-Cd0Kb1Sh.js").then(t=>t.b);return{default:e}},[]).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Cr}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Oe.connecting:return me.Connecting;case Oe.open:return me.Open;case Oe.closing:return me.Closing;default:return me.Closed}}isConnected(){return this.connectionState()===me.Open}channel(e,t={config:{}}){const s=new rn(`realtime:${e}`,t,this);return this.channels.push(s),s}push(e){const{topic:t,event:s,payload:r,ref:i}=e,a=()=>{this.encode(e,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${t} ${s} (${i})`,r),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let s=null;try{s=JSON.parse(atob(t.split(".")[1]))}catch{}if(s&&s.exp&&!(Math.floor(Date.now()/1e3)-s.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${s.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${s.exp}`);this.accessTokenValue=t,this.channels.forEach(r=>{t&&r.updateJoinPayload({access_token:t}),r.joinedOnce&&r._isJoined()&&r._push(Q.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(jr,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:s,event:r,payload:i,ref:a}=t;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${r} ${a&&"("+a+")"||""}`,i),this.channels.filter(o=>o._isMember(s)).forEach(o=>o._trigger(r,i,a)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(Q.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${s}${r}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([Fr],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}}class Jr{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=Oe.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class an extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function D(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class Vr extends an{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Wt extends an{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Gr=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(d){a(d)}}function l(u){try{c(s.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((s=s.apply(n,e||[])).next())})};const hs=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ie(async()=>{const{default:s}=await Promise.resolve().then(()=>Ue);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},zr=()=>Gr(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Ie(()=>Promise.resolve().then(()=>Ue),void 0)).Response:Response}),Qt=n=>{if(Array.isArray(n))return n.map(t=>Qt(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,s])=>{const r=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[r]=Qt(s)}),e};var be=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(d){a(d)}}function l(u){try{c(s.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((s=s.apply(n,e||[])).next())})};const Lt=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Kr=(n,e,t)=>be(void 0,void 0,void 0,function*(){const s=yield zr();n instanceof s&&!(t!=null&&t.noResolveJson)?n.json().then(r=>{e(new Vr(Lt(r),n.status||500))}).catch(r=>{e(new Wt(Lt(r),r))}):e(new Wt(Lt(n),n))}),Wr=(n,e,t,s)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s&&(r.body=JSON.stringify(s)),Object.assign(Object.assign({},r),t))};function lt(n,e,t,s,r,i){return be(this,void 0,void 0,function*(){return new Promise((a,o)=>{n(t,Wr(e,s,r,i)).then(l=>{if(!l.ok)throw l;return s!=null&&s.noResolveJson?l:l.json()}).then(l=>a(l)).catch(l=>Kr(l,o,s))})})}function St(n,e,t,s){return be(this,void 0,void 0,function*(){return lt(n,"GET",e,t,s)})}function ce(n,e,t,s,r){return be(this,void 0,void 0,function*(){return lt(n,"POST",e,s,r,t)})}function Qr(n,e,t,s,r){return be(this,void 0,void 0,function*(){return lt(n,"PUT",e,s,r,t)})}function Yr(n,e,t,s){return be(this,void 0,void 0,function*(){return lt(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function fs(n,e,t,s,r){return be(this,void 0,void 0,function*(){return lt(n,"DELETE",e,s,r,t)})}var F=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(d){a(d)}}function l(u){try{c(s.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((s=s.apply(n,e||[])).next())})};const Xr={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},jn={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Zr{constructor(e,t={},s,r){this.url=e,this.headers=t,this.bucketId=s,this.fetch=hs(r)}uploadOrUpdate(e,t,s,r){return F(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},jn),r);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const l=a.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",a.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=s,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),r!=null&&r.headers&&(o=Object.assign(Object.assign({},o),r.headers));const c=this._removeEmptyFolders(t),u=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${u}`,Object.assign({method:e,body:i,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{})),h=yield d.json();return d.ok?{data:{path:c,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(i){if(D(i))return{data:null,error:i};throw i}})}upload(e,t,s){return F(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,r){return F(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let l;const c=Object.assign({upsert:jn.upsert},r),u=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&s instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",s)):typeof FormData<"u"&&s instanceof FormData?(l=s,l.append("cacheControl",c.cacheControl)):(l=s,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType);const d=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:u}),h=yield d.json();return d.ok?{data:{path:i,fullPath:h.Key},error:null}:{data:null,error:h}}catch(l){if(D(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(e,t){return F(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const r=Object.assign({},this.headers);t!=null&&t.upsert&&(r["x-upsert"]="true");const i=yield ce(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:r}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new an("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(s){if(D(s))return{data:null,error:s};throw s}})}update(e,t,s){return F(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return F(this,void 0,void 0,function*(){try{return{data:yield ce(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(D(r))return{data:null,error:r};throw r}})}copy(e,t,s){return F(this,void 0,void 0,function*(){try{return{data:{path:(yield ce(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(D(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,s){return F(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),i=yield ce(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const a=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(r){if(D(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,s){return F(this,void 0,void 0,function*(){try{const r=yield ce(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:r.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(r){if(D(r))return{data:null,error:r};throw r}})}download(e,t){return F(this,void 0,void 0,function*(){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=i?`?${i}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield St(this.fetch,`${this.url}/${r}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(D(o))return{data:null,error:o};throw o}})}info(e){return F(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield St(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:Qt(s),error:null}}catch(s){if(D(s))return{data:null,error:s};throw s}})}exists(e){return F(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Yr(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(D(s)&&s instanceof Wt){const r=s.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),r=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&r.push(i);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&r.push(l);let c=r.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${s}${c}`)}}}remove(e){return F(this,void 0,void 0,function*(){try{return{data:yield fs(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(D(t))return{data:null,error:t};throw t}})}list(e,t,s){return F(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},Xr),t),{prefix:e||""});return{data:yield ce(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(D(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const ei="2.7.1",ti={"X-Client-Info":`storage-js/${ei}`};var xe=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(d){a(d)}}function l(u){try{c(s.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((s=s.apply(n,e||[])).next())})};class ni{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},ti),t),this.fetch=hs(s)}listBuckets(){return xe(this,void 0,void 0,function*(){try{return{data:yield St(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(D(e))return{data:null,error:e};throw e}})}getBucket(e){return xe(this,void 0,void 0,function*(){try{return{data:yield St(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(D(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return xe(this,void 0,void 0,function*(){try{return{data:yield ce(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(D(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return xe(this,void 0,void 0,function*(){try{return{data:yield Qr(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(D(s))return{data:null,error:s};throw s}})}emptyBucket(e){return xe(this,void 0,void 0,function*(){try{return{data:yield ce(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(D(t))return{data:null,error:t};throw t}})}deleteBucket(e){return xe(this,void 0,void 0,function*(){try{return{data:yield fs(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(D(t))return{data:null,error:t};throw t}})}}class si extends ni{constructor(e,t={},s){super(e,t,s)}from(e){return new Zr(this.url,this.headers,e,this.fetch)}}const ri="2.47.12";let Ye="";typeof Deno<"u"?Ye="deno":typeof document<"u"?Ye="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ye="react-native":Ye="node";const ii={"X-Client-Info":`supabase-js-${Ye}/${ri}`},ai={headers:ii},oi={schema:"public"},li={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},ui={};var ci=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(d){a(d)}}function l(u){try{c(s.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((s=s.apply(n,e||[])).next())})};const di=n=>{let e;return n?e=n:typeof fetch>"u"?e=ns:e=fetch,(...t)=>e(...t)},hi=()=>typeof Headers>"u"?ss:Headers,fi=(n,e,t)=>{const s=di(t),r=hi();return(i,a)=>ci(void 0,void 0,void 0,function*(){var o;const l=(o=yield e())!==null&&o!==void 0?o:n;let c=new r(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",n),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),s(i,Object.assign(Object.assign({},a),{headers:c}))})};var gi=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(d){a(d)}}function l(u){try{c(s.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((s=s.apply(n,e||[])).next())})};function pi(n){return n.replace(/\/$/,"")}function _i(n,e){const{db:t,auth:s,realtime:r,global:i}=n,{db:a,auth:o,realtime:l,global:c}=e,u={db:Object.assign(Object.assign({},a),t),auth:Object.assign(Object.assign({},o),s),realtime:Object.assign(Object.assign({},l),r),global:Object.assign(Object.assign({},c),i),accessToken:()=>gi(this,void 0,void 0,function*(){return""})};return n.accessToken?u.accessToken=n.accessToken:delete u.accessToken,u}const gs="2.67.3",yi="http://localhost:9999",mi="supabase.auth.token",wi={"X-Client-Info":`gotrue-js/${gs}`},In=10,Yt="X-Supabase-Api-Version",ps={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function bi(n){return Math.round(Date.now()/1e3)+n}function vi(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const te=()=>typeof window<"u"&&typeof document<"u",_e={tested:!1,writable:!1},tt=()=>{if(!te())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(_e.tested)return _e.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),_e.tested=!0,_e.writable=!0}catch{_e.tested=!0,_e.writable=!1}return _e.writable};function ki(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((r,i)=>{e[i]=r})}catch{}return t.searchParams.forEach((s,r)=>{e[r]=s}),e}const _s=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Ie(async()=>{const{default:s}=await Promise.resolve().then(()=>Ue);return{default:s}},void 0).then(({default:s})=>s(...t)):e=fetch,(...t)=>e(...t)},Si=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",ys=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},ft=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},gt=async(n,e)=>{await n.removeItem(e)};function $i(n){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",s,r,i,a,o,l,c,u=0;for(n=n.replace("-","+").replace("_","/");u<n.length;)a=e.indexOf(n.charAt(u++)),o=e.indexOf(n.charAt(u++)),l=e.indexOf(n.charAt(u++)),c=e.indexOf(n.charAt(u++)),s=a<<2|o>>4,r=(o&15)<<4|l>>2,i=(l&3)<<6|c,t=t+String.fromCharCode(s),l!=64&&r!=0&&(t=t+String.fromCharCode(r)),c!=64&&i!=0&&(t=t+String.fromCharCode(i));return t}class Ct{constructor(){this.promise=new Ct.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Ct.promiseConstructor=Promise;function Rn(n){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=n.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const s=t[1];return JSON.parse($i(s))}async function xi(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function Ei(n,e){return new Promise((s,r)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await n(i);if(!e(i,null,a)){s(a);return}}catch(a){if(!e(i,a)){r(a);return}}})()})}function Pi(n){return("0"+n.toString(16)).substr(-2)}function Oi(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let r="";for(let i=0;i<56;i++)r+=t.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(e),Array.from(e,Pi).join("")}async function Ti(n){const t=new TextEncoder().encode(n),s=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(s);return Array.from(r).map(i=>String.fromCharCode(i)).join("")}function Ai(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Ci(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await Ti(n);return Ai(t)}async function Ee(n,e,t=!1){const s=Oi();let r=s;t&&(r+="/PASSWORD_RECOVERY"),await ys(n,`${e}-code-verifier`,r);const i=await Ci(s);return[i,s===i?"plain":"s256"]}const ji=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function Ii(n){const e=n.headers.get(Yt);if(!e||!e.match(ji))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class on extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function S(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class Ri extends on{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function Li(n){return S(n)&&n.name==="AuthApiError"}class ms extends on{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class ve extends on{constructor(e,t,s,r){super(e,s,r),this.name=t,this.status=s}}class le extends ve{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Di(n){return S(n)&&n.name==="AuthSessionMissingError"}class Dt extends ve{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class pt extends ve{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class _t extends ve{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Ui(n){return S(n)&&n.name==="AuthImplicitGrantRedirectError"}class Ln extends ve{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Xt extends ve{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function Ut(n){return S(n)&&n.name==="AuthRetryableFetchError"}class Dn extends ve{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}var Ni=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t};const ye=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Bi=[502,503,504];async function Un(n){var e;if(!Si(n))throw new Xt(ye(n),0);if(Bi.includes(n.status))throw new Xt(ye(n),n.status);let t;try{t=await n.json()}catch(i){throw new ms(ye(i),i)}let s;const r=Ii(n);if(r&&r.getTime()>=ps["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new Dn(ye(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new le}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new Dn(ye(t),n.status,t.weak_password.reasons);throw new Ri(ye(t),n.status||500,s)}const qi=(n,e,t,s)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),t))};async function x(n,e,t,s){var r;const i=Object.assign({},s==null?void 0:s.headers);i[Yt]||(i[Yt]=ps["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const a=(r=s==null?void 0:s.query)!==null&&r!==void 0?r:{};s!=null&&s.redirectTo&&(a.redirect_to=s.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",l=await Mi(n,e,t+o,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function Mi(n,e,t,s,r,i){const a=qi(e,s,r,i);let o;try{o=await n(t,Object.assign({},a))}catch(l){throw console.error(l),new Xt(ye(l),0)}if(o.ok||await Un(o),s!=null&&s.noResolveJson)return o;try{return await o.json()}catch(l){await Un(l)}}function ue(n){var e;let t=null;Vi(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=bi(n.expires_in)));const s=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:s},error:null}}function Nn(n){const e=ue(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=n.weak_password),e}function de(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function Fi(n){return{data:n,error:null}}function Hi(n){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:r,verification_type:i}=n,a=Ni(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:s,redirect_to:r,verification_type:i},l=Object.assign({},a);return{data:{properties:o,user:l},error:null}}function Ji(n){return n}function Vi(n){return n.access_token&&n.refresh_token&&n.expires_in}var Gi=function(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t};class zi{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=_s(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await x(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(S(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await x(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:de})}catch(s){if(S(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=Gi(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=s==null?void 0:s.newEmail,delete r.newEmail),await x(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:Hi,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(S(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await x(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:de})}catch(t){if(S(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,r,i,a,o,l;try{const c={nextPage:null,lastPage:0,total:0},u=await x(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:Ji});if(u.error)throw u.error;const d=await u.json(),h=(a=u.headers.get("x-total-count"))!==null&&a!==void 0?a:0,f=(l=(o=u.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(g=>{const y=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),p=JSON.parse(g.split(";")[1].split("=")[1]);c[`${p}Page`]=y}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(S(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await x(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:de})}catch(t){if(S(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await x(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:de})}catch(s){if(S(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){try{return await x(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:de})}catch(s){if(S(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:t,error:s}=await x(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:t,error:s}}catch(t){if(S(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await x(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(S(t))return{data:null,error:t};throw t}}}const Ki={getItem:n=>tt()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{tt()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{tt()&&globalThis.localStorage.removeItem(n)}};function Bn(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function Wi(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Pe={debug:!!(globalThis&&tt()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class ws extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Qi extends ws{}async function Yi(n,e,t){Pe.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Pe.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async r=>{if(r){Pe.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,r.name);try{return await t()}finally{Pe.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,r.name)}}else{if(e===0)throw Pe.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Qi(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Pe.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}Wi();const Xi={url:yi,storageKey:mi,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:wi,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},We=30*1e3,qn=3;async function Mn(n,e,t){return await t()}class rt{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=rt.nextInstanceID,rt.nextInstanceID+=1,this.instanceID>0&&te()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},Xi),e);if(this.logDebugMessages=!!r.debug,typeof r.debug=="function"&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new zi({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=_s(r.fetch),this.lock=r.lock||Mn,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:te()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=Yi:this.lock=Mn,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:tt()?this.storage=Ki:(this.memoryStorage={},this.storage=Bn(this.memoryStorage)):(this.memoryStorage={},this.storage=Bn(this.memoryStorage)),te()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${gs}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=ki(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),te()&&this.detectSessionInUrl&&s!=="none"){const{data:r,error:i}=await this._getSessionFromURL(t,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Ui(i)){const l=(e=i.details)===null||e===void 0?void 0:e.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:o}=r;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return S(t)?{error:t}:{error:new ms("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,r;try{const i=await x(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:ue}),{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(S(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var t,s,r;try{let i;if("email"in e){const{email:u,password:d,options:h}=e;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await Ee(this.storage,this.storageKey)),i=await x(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:u,password:d,data:(t=h==null?void 0:h.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:f,code_challenge_method:g},xform:ue})}else if("phone"in e){const{phone:u,password:d,options:h}=e;i=await x(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:d,data:(s=h==null?void 0:h.data)!==null&&s!==void 0?s:{},channel:(r=h==null?void 0:h.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:ue})}else throw new pt("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const l=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(i){if(S(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:a,options:o}=e;t=await x(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Nn})}else if("phone"in e){const{phone:i,password:a,options:o}=e;t=await x(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Nn})}else throw new pt("You must provide either an email or phone number and a password");const{data:s,error:r}=t;return r?{data:{user:null,session:null},error:r}:!s||!s.session||!s.user?{data:{user:null,session:null},error:new Dt}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r})}catch(t){if(S(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,r,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await ft(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(t??"").split("/");try{const{data:i,error:a}=await x(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:ue});if(await gt(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Dt}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:r??null}),error:a})}catch(i){if(S(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:t,provider:s,token:r,access_token:i,nonce:a}=e,o=await x(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:ue}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new Dt}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(t){if(S(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,r,i,a;try{if("email"in e){const{email:o,options:l}=e;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await Ee(this.storage,this.storageKey));const{error:d}=await x(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=l==null?void 0:l.data)!==null&&t!==void 0?t:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:o,options:l}=e,{data:c,error:u}=await x(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(i=l==null?void 0:l.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(a=l==null?void 0:l.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new pt("You must provide either an email or phone number.")}catch(o){if(S(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,s;try{let r,i;"options"in e&&(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:a,error:o}=await x(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:ue});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const l=a.session,c=a.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(r){if(S(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,s,r;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await Ee(this.storage,this.storageKey)),await x(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:Fi})}catch(i){if(S(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new le;const{error:r}=await x(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}})}catch(e){if(S(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:i}=e,{error:a}=await x(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:s,type:r,options:i}=e,{data:a,error:o}=await x(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new pt("You must provide either an email or phone number and a type")}catch(t){if(S(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await ft(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(l,c,u)=>(!a&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,u))})}return{data:{session:e},error:null}}const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await x(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:de}):await this._useSession(async t=>{var s,r,i;const{data:a,error:o}=t;if(o)throw o;return!(!((s=a.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new le}:await x(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0,xform:de})})}catch(t){if(S(t))return Di(t)&&(await this._removeSession(),await gt(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:r,error:i}=s;if(i)throw i;if(!r.session)throw new le;const a=r.session;let o=null,l=null;this.flowType==="pkce"&&e.email!=null&&([o,l]=await Ee(this.storage,this.storageKey));const{data:c,error:u}=await x(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:l}),jwt:a.access_token,xform:de});if(u)throw u;return a.user=c.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(s){if(S(s))return{data:{user:null},error:s};throw s}}_decodeJWT(e){return Rn(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new le;const t=Date.now()/1e3;let s=t,r=!0,i=null;const a=Rn(e.access_token);if(a.exp&&(s=a.exp,r=s<=t),r){const{session:o,error:l}=await this._callRefreshToken(e.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:l}=await this._getUser(e.access_token);if(l)throw l;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(S(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:a,error:o}=t;if(o)throw o;e=(s=a.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new le;const{session:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(S(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!te())throw new _t("No browser detected.");if(e.error||e.error_description||e.error_code)throw new _t(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Ln("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new _t("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Ln("No code detected.");const{data:k,error:v}=await this._exchangeCodeForSession(e.code);if(v)throw v;const m=new URL(window.location.href);return m.searchParams.delete("code"),window.history.replaceState(window.history.state,"",m.toString()),{data:{session:k.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:i,refresh_token:a,expires_in:o,expires_at:l,token_type:c}=e;if(!i||!o||!a||!c)throw new _t("No session defined in URL");const u=Math.round(Date.now()/1e3),d=parseInt(o);let h=u+d;l&&(h=parseInt(l));const f=h-u;f*1e3<=We&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${d}s`);const g=h-d;u-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,u):u-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,h,u);const{data:y,error:p}=await this._getUser(i);if(p)throw p;const b={provider_token:s,provider_refresh_token:r,access_token:i,expires_in:d,expires_at:h,refresh_token:a,token_type:c,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:e.type},error:null}}catch(s){if(S(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await ft(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:r,error:i}=t;if(i)return{error:i};const a=(s=r.session)===null||s===void 0?void 0:s.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(Li(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await gt(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=vi(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,r;try{const{data:{session:i},error:a}=t;if(a)throw a;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let s=null,r=null;this.flowType==="pkce"&&([s,r]=await Ee(this.storage,this.storageKey,!0));try{return await x(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(S(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(S(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:r}=await this._useSession(async i=>{var a,o,l,c,u;const{data:d,error:h}=i;if(h)throw h;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=e.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await x(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(r)throw r;return te()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),{data:{provider:e.provider,url:s==null?void 0:s.url},error:null}}catch(s){if(S(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,r;const{data:i,error:a}=t;if(a)throw a;return await x(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0})})}catch(t){if(S(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await Ei(async r=>(r>0&&await xi(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await x(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:ue})),(r,i)=>{const a=200*Math.pow(2,r);return i&&Ut(i)&&Date.now()+a-s<We})}catch(s){if(this._debug(t,"error",s),S(s))return{data:{session:null,user:null},error:s};throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),te()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await ft(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s)){this._debug(t,"session is not valid"),s!==null&&await this._removeSession();return}const r=Math.round(Date.now()/1e3),i=((e=s.expires_at)!==null&&e!==void 0?e:1/0)<r+In;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${In}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:a}=await this._callRefreshToken(s.refresh_token);a&&(console.error(a),Ut(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(t,"error",s),console.error(s);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new le;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Ct;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new le;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(r,"error",i),S(i)){const a={session:null,error:i};return Ut(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(l){i.push(l)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await ys(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await gt(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&te()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),We);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-e)/We);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${We}ms, refresh threshold is ${qn} ticks`),r<=qn&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof ws)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!te()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const r=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,a]=await Ee(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});r.push(o.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);r.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;return i?{data:null,error:i}:await x(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(S(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,r;const{data:i,error:a}=t;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:l,error:c}=await x(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return c?{data:null,error:c}:(e.factorType==="totp"&&(!((r=l==null?void 0:l.totp)===null||r===void 0)&&r.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(t){if(S(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;if(i)return{data:null,error:i};const{data:a,error:o}=await x(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(t){if(S(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;return i?{data:null,error:i}:await x(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(S(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(e==null?void 0:e.factors)||[],r=s.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=s.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:s,totp:r,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,s;const{data:{session:r},error:i}=e;if(i)return{data:null,error:i};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(r.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((s=(t=r.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:u},error:null}}))}}rt.nextInstanceID=0;const Zi=rt;class ea extends Zi{constructor(e){super(e)}}var ta=function(n,e,t,s){function r(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(u){try{c(s.next(u))}catch(d){a(d)}}function l(u){try{c(s.throw(u))}catch(d){a(d)}}function c(u){u.done?i(u.value):r(u.value).then(o,l)}c((s=s.apply(n,e||[])).next())})};class na{constructor(e,t,s){var r,i,a;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const o=pi(e);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:oi,realtime:ui,auth:Object.assign(Object.assign({},li),{storageKey:l}),global:ai},u=_i(s??{},c);this.storageKey=(r=u.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(i=u.global.headers)!==null&&i!==void 0?i:{},u.accessToken?(this.accessToken=u.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=u.auth)!==null&&a!==void 0?a:{},this.headers,u.global.fetch),this.fetch=fi(t,this._getAccessToken.bind(this),u.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},u.realtime)),this.rest=new Or(`${o}/rest/v1`,{headers:this.headers,schema:u.db.schema,fetch:this.fetch}),u.accessToken||this._listenForAuthEvents()}get functions(){return new gr(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new si(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return ta(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,storageKey:i,flowType:a,lock:o,debug:l},c,u){var d;const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ea({url:this.authUrl,headers:Object.assign(Object.assign({},h),c),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,flowType:a,lock:o,debug:l,fetch:u,hasCustomAuthorizationHeader:(d="Authorization"in this.headers)!==null&&d!==void 0?d:!1})}_initRealtimeClient(e){return new Hr(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?this.changedAccessToken=s:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const sa=(n,e,t)=>new na(n,e,t),Fn={supabaseConfig:{supabaseUrl:"https://iaexzqaebipowfifmshv.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlhZXh6cWFlYmlwb3dmaWZtc2h2Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzYyMzQyMDQsImV4cCI6MjA1MTgxMDIwNH0.73mCQ4KRVQs1gIbwESq3HDh9go3q-oKiUCBrFEKA-8c"}},G=sa(Fn.supabaseConfig.supabaseUrl,Fn.supabaseConfig.supabaseAnonKey),Zt=Symbol("store-raw"),Te=Symbol("store-node"),se=Symbol("store-has"),bs=Symbol("store-self");function vs(n){let e=n[X];if(!e&&(Object.defineProperty(n,X,{value:e=new Proxy(n,aa)}),!Array.isArray(n))){const t=Object.keys(n),s=Object.getOwnPropertyDescriptors(n);for(let r=0,i=t.length;r<i;r++){const a=t[r];s[a].get&&Object.defineProperty(n,a,{enumerable:s[a].enumerable,get:s[a].get.bind(e)})}}return e}function $t(n){let e;return n!=null&&typeof n=="object"&&(n[X]||!(e=Object.getPrototypeOf(n))||e===Object.prototype||Array.isArray(n))}function it(n,e=new Set){let t,s,r,i;if(t=n!=null&&n[Zt])return t;if(!$t(n)||e.has(n))return n;if(Array.isArray(n)){Object.isFrozen(n)?n=n.slice(0):e.add(n);for(let a=0,o=n.length;a<o;a++)r=n[a],(s=it(r,e))!==r&&(n[a]=s)}else{Object.isFrozen(n)?n=Object.assign({},n):e.add(n);const a=Object.keys(n),o=Object.getOwnPropertyDescriptors(n);for(let l=0,c=a.length;l<c;l++)i=a[l],!o[i].get&&(r=n[i],(s=it(r,e))!==r&&(n[i]=s))}return n}function xt(n,e){let t=n[e];return t||Object.defineProperty(n,e,{value:t=Object.create(null)}),t}function at(n,e,t){if(n[e])return n[e];const[s,r]=O(t,{equals:!1,internal:!0});return s.$=r,n[e]=s}function ra(n,e){const t=Reflect.getOwnPropertyDescriptor(n,e);return!t||t.get||!t.configurable||e===X||e===Te||(delete t.value,delete t.writable,t.get=()=>n[X][e]),t}function ks(n){Mt()&&at(xt(n,Te),bs)()}function ia(n){return ks(n),Reflect.ownKeys(n)}const aa={get(n,e,t){if(e===Zt)return n;if(e===X)return t;if(e===qt)return ks(n),t;const s=xt(n,Te),r=s[e];let i=r?r():n[e];if(e===Te||e===se||e==="__proto__")return i;if(!r){const a=Object.getOwnPropertyDescriptor(n,e);Mt()&&(typeof i!="function"||n.hasOwnProperty(e))&&!(a&&a.get)&&(i=at(s,e,i)())}return $t(i)?vs(i):i},has(n,e){return e===Zt||e===X||e===qt||e===Te||e===se||e==="__proto__"?!0:(Mt()&&at(xt(n,se),e)(),e in n)},set(){return!0},deleteProperty(){return!0},ownKeys:ia,getOwnPropertyDescriptor:ra};function Et(n,e,t,s=!1){if(!s&&n[e]===t)return;const r=n[e],i=n.length;t===void 0?(delete n[e],n[se]&&n[se][e]&&r!==void 0&&n[se][e].$()):(n[e]=t,n[se]&&n[se][e]&&r===void 0&&n[se][e].$());let a=xt(n,Te),o;if((o=at(a,e,r))&&o.$(()=>t),Array.isArray(n)&&n.length!==i){for(let l=n.length;l<i;l++)(o=a[l])&&o.$();(o=at(a,"length",i))&&o.$(n.length)}(o=a[bs])&&o.$()}function Ss(n,e){const t=Object.keys(e);for(let s=0;s<t.length;s+=1){const r=t[s];Et(n,r,e[r])}}function oa(n,e){if(typeof e=="function"&&(e=e(n)),e=it(e),Array.isArray(e)){if(n===e)return;let t=0,s=e.length;for(;t<s;t++){const r=e[t];n[t]!==r&&Et(n,t,r)}Et(n,"length",s)}else Ss(n,e)}function Xe(n,e,t=[]){let s,r=n;if(e.length>1){s=e.shift();const a=typeof s,o=Array.isArray(n);if(Array.isArray(s)){for(let l=0;l<s.length;l++)Xe(n,[s[l]].concat(e),t);return}else if(o&&a==="function"){for(let l=0;l<n.length;l++)s(n[l],l)&&Xe(n,[l].concat(e),t);return}else if(o&&a==="object"){const{from:l=0,to:c=n.length-1,by:u=1}=s;for(let d=l;d<=c;d+=u)Xe(n,[d].concat(e),t);return}else if(e.length>1){Xe(n[s],e,[s].concat(t));return}r=n[s],t=[s].concat(t)}let i=e[0];typeof i=="function"&&(i=i(r,t),i===r)||s===void 0&&i==null||(i=it(i),s===void 0||$t(r)&&$t(i)&&!Array.isArray(i)?Ss(r,i):Et(n,s,i))}function la(...[n,e]){const t=it(n||{}),s=Array.isArray(t),r=vs(t);function i(...a){As(()=>{s&&a.length===1?oa(t,a[0]):Xe(t,a)})}return[r,i]}const[_,Z]=la({user_type:"guest"}),N=[];for(let n=0;n<256;++n)N.push((n+256).toString(16).slice(1));function ua(n,e=0){return(N[n[e+0]]+N[n[e+1]]+N[n[e+2]]+N[n[e+3]]+"-"+N[n[e+4]]+N[n[e+5]]+"-"+N[n[e+6]]+N[n[e+7]]+"-"+N[n[e+8]]+N[n[e+9]]+"-"+N[n[e+10]]+N[n[e+11]]+N[n[e+12]]+N[n[e+13]]+N[n[e+14]]+N[n[e+15]]).toLowerCase()}let Nt;const ca=new Uint8Array(16);function da(){if(!Nt){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Nt=crypto.getRandomValues.bind(crypto)}return Nt(ca)}const ha=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Hn={randomUUID:ha};function fa(n,e,t){var r;if(Hn.randomUUID&&!n)return Hn.randomUUID();n=n||{};const s=n.random??((r=n.rng)==null?void 0:r.call(n))??da();if(s.length<16)throw new Error("Random bytes length must be >= 16");return s[6]=s[6]&15|64,s[8]=s[8]&63|128,ua(s)}const we="game_sessions",ge="players_table";function ga(n){let e="";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",s=t.length;let r=0;for(;r<n;)e+=t.charAt(Math.floor(Math.random()*s)),r+=1;return e}async function pa(){const n=sessionStorage.getItem("host_id"),e=sessionStorage.getItem("game_id"),t=sessionStorage.getItem("history"),s=sessionStorage.getItem("username");if(n&&e){const{data:r,error:i}=await G.from(we).select().eq("host_id",n).eq("game_id",e);r&&r.length>0&&!i&&Z({user_type:"host",host_id:n,started:r[0].started,game_id:e,game_data:{prompt:"",duration:r[0].game_data.duration},history:JSON.parse(t||"[]")})}else if(s&&e){const{data:r,error:i}=await G.from(ge).select().eq("username",s).eq("game_id",e);r&&r.length>0&&!i&&Z({user_type:"player",username:s,game_id:e,entered_data:r[0].entered_data})}}function Ae(){_.user_type==="host"?(sessionStorage.setItem("host_id",_.host_id),sessionStorage.setItem("game_id",_.game_id),sessionStorage.setItem("history",JSON.stringify(_.history))):_.user_type==="player"&&(sessionStorage.setItem("username",_.username),sessionStorage.setItem("game_id",_.game_id),sessionStorage.setItem("entered_data",JSON.stringify(_.entered_data)))}async function _a(){Z({user_type:"host",host_id:fa(),started:!1,game_id:ga(5),game_data:{prompt:"",duration:10},history:Array(0)}),_.user_type==="host"&&(await G.from(we).insert({host_id:_.host_id,game_id:_.game_id,started:!1,game_data:JSON.stringify(_.game_data)}),Ae())}async function $s(){_.user_type==="host"&&await G.from(we).delete().eq("host_id",_.host_id),Z({user_type:"guest"}),sessionStorage.clear()}async function Bt(n){_.user_type==="host"&&(Z(n),console.log({...n}),await G.from(we).update({...n}).eq("host_id",_.host_id))}async function ya(){if(_.user_type!=="host")return;const{data:n,error:e}=await G.from(ge).select().eq("game_id",_.game_id);return e&&console.error(e),n}async function ma(n,e){await G.channel(ge).on("postgres_changes",{event:"UPDATE",schema:"public",table:ge,filter:`game_id=eq.${n}`},t=>{e(t)}).subscribe()}async function wa(n){const{data:e,error:t}=await G.from(we).select().eq("game_id",n);return t?(console.error(t),!1):e.length>0?(console.log("Valid game Id"),!0):!1}async function ba(n,e){const{data:t,error:s}=await G.from(ge).select().eq("game_id",e).eq("username",n);return s?(console.error(s),!1):t.length>0?!1:(console.log(!0),!0)}async function va(n,e){Z({user_type:"player",game_id:n,username:e,entered_data:[]}),_.user_type==="player"&&await G.from(ge).insert({game_id:_.game_id,username:_.username}),Ae()}async function xs(){_.user_type==="player"&&await G.from(ge).delete().eq("username",_.username),Z({user_type:"guest"}),sessionStorage.clear()}async function ka(n,e){await G.channel(we).on("postgres_changes",{event:"UPDATE",schema:"public",table:we,filter:`game_id=eq.${n}`},t=>{e(t)}).subscribe()}async function Sa(n){_.user_type==="player"&&(Z(n),await G.from(ge).update({...n}).eq("username",_.username))}var $a=T("<svg stroke-width=0>");function ln(n,e){const t=fn(n.a,e),[s,r]=Hs(t,["src"]),[i,a]=O(""),o=L(()=>e.title?`${n.c}<title>${e.title}</title>`:n.c);return he(()=>a(o())),en(()=>{a("")}),(()=>{var l=$a();return nr(l,fn({get stroke(){var c;return(c=n.a)==null?void 0:c.stroke},get color(){return e.color||"currentColor"},get fill(){return e.color||"currentColor"},get style(){return{...e.style,overflow:"visible"}}},r,{get height(){return e.size||"1em"},get width(){return e.size||"1em"},xmlns:"http://www.w3.org/2000/svg",get innerHTML(){return i()}}),!0),$(l,()=>ar),l})()}function xa(n){return ln({a:{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",viewBox:"0 0 24 24"},c:'<path d="M1 4 1 10 7 10"/><path d="M23 20 23 14 17 14"/><path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4-4.64 4.36A9 9 0 0 1 3.51 15"/>'},n)}function Ea(n){return ln({a:{viewBox:"0 0 1024 1024"},c:'<path d="M512 1024c-69.1 0-136.2-13.5-199.3-40.2C251.7 958 197 921 150 874c-47-47-84-101.7-109.8-162.7C13.5 648.2 0 581.1 0 512c0-19.9 16.1-36 36-36s36 16.1 36 36c0 59.4 11.6 117 34.6 171.3 22.2 52.4 53.9 99.5 94.3 139.9 40.4 40.4 87.5 72.2 139.9 94.3C395 940.4 452.6 952 512 952c59.4 0 117-11.6 171.3-34.6 52.4-22.2 99.5-53.9 139.9-94.3 40.4-40.4 72.2-87.5 94.3-139.9C940.4 629 952 571.4 952 512c0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 0 0-94.3-139.9 437.71 437.71 0 0 0-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.2C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3s-13.5 136.2-40.2 199.3C958 772.3 921 827 874 874c-47 47-101.8 83.9-162.7 109.7-63.1 26.8-130.2 40.3-199.3 40.3z"/>'},n)}var Pa=T('<div class="flex flex-col h-full items-center bg-background-950 my-10 p-3 rounded-md">'),Oa=T('<div class="app-host-player-list h-[80svh] max-w-[500px] flex flex-col"><div class="flex justify-between items-center"><h1 class="text-center text-2xl">Players</h1><div class=w-6>'),Ta=T('<div class="w-full h-full flex justify-center items-center">'),Aa=T('<div class="w-full my-2 p-2 text-center bg-white rounded-md">');function Ca(){const[n,{refetch:e}]=Ts(async()=>await ya());return(()=>{var t=Oa(),s=t.firstChild,r=s.firstChild;return $(s,B(xa,{class:"h-6 w-6 hover:animate-rotate-ccw",onClick:()=>e(),title:"Refresh"}),r),$(t,B(Vs,{get fallback(){return(()=>{var i=Ta();return $(i,B(Ea,{class:"animate-spin w-[20%] h-[20%]"})),i})()},get children(){var i=Pa();return $(i,B(Tt,{get each(){return n()},children:a=>(()=>{var o=Aa();return $(o,()=>a.username),o})()})),i}}),null),t})()}function ja(n){return ln({a:{fill:"currentColor",viewBox:"0 0 16 16"},c:'<path d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5Zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6Z"/><path d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1ZM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118ZM2.5 3h11V2h-11v1Z"/>'},n)}var Ia=T('<div class="w-full my-2 p-2 text-center bg-white rounded-md"><div class="flex justify-between items-center"><div></div>: <!> answer'),Ra=T("<hr class=m-2>"),La=T('<div class="flex flex-col"><ol class="list-decimal pl-10">'),Da=T('<li class="text-left underline py-2">'),Ua=T('<div class="flex flex-col h-full p-0 m-0"><h1 class="text-center text-2xl">History</h1><div class="flex flex-col h-full w-full items-center bg-background-950 mt-2 p-2 rounded-md overflow-y-scroll">');function Na(n){const e=n.history.words.length,[t,s]=O(!1),r=()=>{_.user_type==="host"&&(Z({history:_.history.filter(i=>i.id!==n.history.id)}),Ae())};return(()=>{var i=Ia(),a=i.firstChild,o=a.firstChild,l=o.nextSibling,c=l.nextSibling;return c.nextSibling,i.$$click=()=>s(!t()),$(a,()=>n.history.prompt,l),$(a,e,c),$(a,e===1?"":"s",null),$(a,B(ja,{onClick:r}),null),$(i,(()=>{var u=L(()=>!!t());return()=>u()&&[Ra(),(()=>{var d=La(),h=d.firstChild;return $(h,()=>n.history.words.map(f=>(()=>{var g=Da();return $(g,f),g})())),d})()]})(),null),i})()}function Ba(){if(_.user_type==="host")return(()=>{var n=Ua(),e=n.firstChild,t=e.nextSibling;return $(t,B(Tt,{get each(){return _.history},children:s=>B(Na,{history:s})})),n})()}ot(["click"]);var qa=T('<div class="w-full my-1 p-2 text-center bg-white rounded-md"><div class="flex justify-between items-center"><div class=text-sm>Duration left</div><div class=text-sm>'),Ma=T("<div class=text-sm>Ready?"),Fa=T("<div class=text-sm>Set "),Ha=T("<div class=text-sm>Go");function Ja(n){if(_.user_type!=="host")return null;const[e,t]=O(!1),[s,r]=O(0);let i,a;return he(()=>{_.user_type==="host"&&(e()&&_.started?(console.log("start"),n.setDurationLeft(_.game_data.duration?_.game_data.duration:10),i=setInterval(()=>{n.setDurationLeft(o=>o-1)},1e3)):!e()&&_.started?(console.log("counddown"),r(3),n.setDurationLeft(_.game_data.duration?_.game_data.duration:10),a=setInterval(()=>{r(o=>o-1)},1e3)):(clearInterval(i),clearInterval(a),t(!1)))}),he(()=>{_.user_type==="host"&&(s()===0&&(t(!0),clearInterval(a)),n.durationLeft===0&&(clearInterval(i),t(!1),n.onDurationEnd()))}),(()=>{var o=qa(),l=o.firstChild,c=l.firstChild,u=c.nextSibling;return $(l,(()=>{var d=L(()=>s()===3);return()=>d()?Ma():(()=>{var h=L(()=>s()===2);return()=>h()?Fa():(()=>{var f=L(()=>s()===1);return()=>f()?Ha():null})()})()})(),u),$(u,()=>n.durationLeft),o})()}var Va=T('<div class="w-full h-full flex"><div class="app-host-view w-full h-full flex flex-col justify-center items-center flex-1"><div class="w-[90svw] h-[80svh] max-w-[500px] flex flex-col justify-between bg-secondary-900 rounded-xl p-5 gap-3"><div class="app-host-top flex justify-between items-center"><button class=warning>Quit</button><h1 class="text-xl flex-1 text-center">Game code: </h1><div></div></div><div class="flex gap-2"><div class="w-1/2 flex flex-col"><label for=prompt>Prompt:</label><input id=prompt placeholder="Enter prompt"autocomplete=off autocorrect=off></div><div class="w-1/2 flex flex-col"><label for=duration>Duration:</label><input placeholder="Enter duration"id=duration type=number></div></div><div class="flex gap-2"><button class=flex-1></button><button class=flex-1> New Prompt</button></div><div class="flex flex-col h-full w-full items-center bg-background-950 mt-2 p-2 rounded-md overflow-y-scroll"></div><div class="flex justify-between"><p class="cursor-pointer hover:underline">Show players</p><p class="cursor-pointer hover:underline">Show history</p></div></div></div><div class="h-full px-5">'),Ga=T('<div class="w-full my-2 p-2 text-center bg-white rounded-md">'),Jn=T('<div class="w-full h-full flex flex-col justify-center items-center flex-1"><div class="w-[90svw] h-[80svh] max-w-[500px] flex flex-col justify-between bg-secondary-900 rounded-xl p-5 gap-3">');function za(){if(_.user_type!=="host")return null;let n,e;const[t,s]=O(!1),[r,i]=O(!1),[a,o]=O([]),[l,c]=O(0),u=()=>{_.user_type!=="host"||n.value===""||(Bt({game_data:{prompt:n.value,duration:e.value}}),Ae())},d=()=>{if(_.user_type!=="host"||n.value===""||e.value==="")return;_.started?f():h()},h=()=>{_.user_type!=="host"||n.value===""||(Bt({started:!0}),o([]),Ae())},f=()=>{_.user_type!=="host"||n.value===""||(Bt({started:!1}),c(_.game_data.duration?_.game_data.duration:10))};Cs(()=>{_.user_type==="host"&&(n.value=_.game_data.prompt||"",e.value=_.game_data.duration||10)});const g=p=>{if(_.user_type!=="host")return;const b=JSON.parse(p.new.entered_data);o(k=>[...k,`${p.new.username} entered "${b[b.length-1]}"`])};ma(_.game_id,g);const y=()=>{if(!(_.user_type!=="host"||n.value.trim()==="")){if(a().length===0){n.value="";return}Z({history:[..._.history,{prompt:n.value,words:a(),id:Date.now()}]}),o([]),n.value="",sessionStorage.setItem("history",JSON.stringify(_.history)),Ae()}};return(()=>{var p=Va(),b=p.firstChild,k=b.firstChild,v=k.firstChild,m=v.firstChild,w=m.nextSibling;w.firstChild;var z=v.nextSibling,ee=z.firstChild,K=ee.firstChild,P=K.nextSibling,I=ee.nextSibling,C=I.firstChild,M=C.nextSibling,ut=z.nextSibling,pe=ut.firstChild,Ne=pe.nextSibling,ke=ut.nextSibling,ct=ke.nextSibling,Be=ct.firstChild,H=Be.nextSibling,oe=b.nextSibling;At(m,"click",$s,!0),$(w,()=>_.game_id,null),P.addEventListener("blur",u);var qe=n;typeof qe=="function"?je(qe,P):n=P,st(P,"spellcheck",!1),M.addEventListener("blur",u);var Me=e;return typeof Me=="function"?je(Me,M):e=M,pe.$$click=d,$(pe,()=>_.started?"Stop":"Start"),Ne.$$click=y,$(k,B(Ja,{get durationLeft(){return l()},setDurationLeft:c,onDurationEnd:f}),ke),$(ke,B(Tt,{get each(){return a()},children:J=>(()=>{var W=Ga();return $(W,J),W})()})),Be.$$click=()=>{i(!1),s(!t())},H.$$click=()=>{s(!1),i(!r())},$(oe,(()=>{var J=L(()=>!!t());return()=>J()&&(()=>{var W=Jn(),Se=W.firstChild;return $(Se,B(Ca,{})),W})()})(),null),$(oe,(()=>{var J=L(()=>!!r());return()=>J()&&(()=>{var W=Jn(),Se=W.firstChild;return $(Se,B(Ba,{})),W})()})(),null),re(J=>{var W=_.started||a().length>0,Se=_.started,un=_.started;return W!==J.e&&(P.disabled=J.e=W),Se!==J.t&&(M.disabled=J.t=Se),un!==J.a&&(Ne.disabled=J.a=un),J},{e:void 0,t:void 0,a:void 0}),p})()}ot(["click"]);var Ka=T('<div class="app-player-view w-full h-full flex flex-col justify-center items-center flex-1"><div class="w-[90svw] h-[80svh] max-w-[500px] flex flex-col bg-secondary-900 rounded-xl p-5 gap-3"><div><div class="app-player-top flex justify-between items-center"><button class=warning>Quit</button><h1 class="text-center text-xl">Welcome, </h1><div class=w-12></div></div></div><div class="app-player-main flex flex-col items-center px-10 py-0 h-full"><h1></h1><div class="flex flex-col gap-1 w-full mt-5 mb-5"><label for=user-input class="">Enter your word: </label><input id=user-input class=flex-1 placeholder=Word></div><button class=w-full>Submit</button><div class="flex flex-col h-full w-full items-center bg-background-950 mt-2 p-2 rounded-md"></div><progress class="w-full accent-slate-500">'),Wa=T('<div class="starting-overlay fixed w-screen h-screen bg-[rgba(0,0,0,0.7)] text-white"><div class="flex flex-col justify-center items-center h-[100svh]"><h1 class=text-2xl>Game starting in <!> seconds'),Qa=T('<div class="w-full my-2 p-2 text-center bg-white rounded-md">');function Ya(){if(_.user_type!=="player")return null;const[n,e]=O(""),[t,s]=O(!1),[r,i]=O(!1),[a,o]=O(3),[l,c]=O(0),[u,d]=O(0),[h,f]=O([]);let g,y,p;he(()=>{r()?(console.log("starting"),o(3),d(l()),y=setInterval(()=>{o(m=>m-1)},1e3)):(console.log("stopped"),clearInterval(y),i(!1))}),he(()=>{a()<=0&&r()&&(console.log(a()),console.log("starting game"),clearInterval(y),i(!1),s(!0),p=setInterval(()=>{d(m=>m-1)},1e3))}),he(()=>{u()<=0&&(clearInterval(p),s(!1),d(0),e(""))});const b=()=>{g.value="",console.log("resetting entered words"),f([]),Z({entered_data:[]})},k=m=>{i(m.new.started),s(m.new.started),c(m.new.game_data.duration),clearInterval(p),m.new.started&&(e(m.new.game_data.prompt),b())};ka(_.game_id,k);const v=()=>{if(_.user_type!=="player"||g.value==="")return null;f(m=>[...m,g.value]),g.value="",Sa({entered_data:h()})};return[L(()=>L(()=>!!r())()&&(()=>{var m=Wa(),w=m.firstChild,z=w.firstChild,ee=z.firstChild,K=ee.nextSibling;return K.nextSibling,$(z,a,K),m})()),(()=>{var m=Ka(),w=m.firstChild,z=w.firstChild,ee=z.firstChild,K=ee.firstChild,P=K.nextSibling;P.firstChild;var I=z.nextSibling,C=I.firstChild,M=C.nextSibling,ut=M.firstChild,pe=ut.nextSibling,Ne=M.nextSibling,ke=Ne.nextSibling,ct=ke.nextSibling;At(K,"click",xs,!0),$(P,()=>_.username,null),$(C,(()=>{var H=L(()=>!!n());return()=>H()?n():"Prompt will show up here"})());var Be=g;return typeof Be=="function"?je(Be,pe):g=pe,Ne.$$click=v,$(ke,B(Tt,{get each(){return h()},children:H=>(()=>{var oe=Qa();return $(oe,H),oe})()})),re(H=>{var oe="text-center text-[1.3rem] "+(t()?"":"underline decoration-accent-100 decoration-[5px] underline-offset-8"),qe=!t(),Me=l();return oe!==H.e&&ts(C,H.e=oe),qe!==H.t&&(pe.disabled=H.t=qe),Me!==H.a&&st(ct,"max",H.a=Me),H},{e:void 0,t:void 0,a:void 0}),re(()=>ct.value=u()),m})()]}ot(["click"]);var Xa=T('<div class="app-user-select w-full h-full flex flex-col justify-center items-center"><div class="bg-secondary-900 rounded-xl p-5 px-7">'),Za=T("<h1 class=text-3xl>Would you like to:"),eo=T('<div class="flex gap-4 flex-col my-4"><button>Host a game</button><button>Join a game'),to=T('<div><h1 class="text-3xl mb-5">Enter game code: </h1><input class="w-full h-10"><div class="flex gap-2 pt-2"><button class=flex-1>Back</button><button class=flex-1>Go'),Vn=T("<p class=text-red-600>"),no=T('<div><h1 class="text-3xl mb-5">Enter username: </h1><input class="w-full h-10"><div class="flex gap-2 pt-2"><button class=flex-1>Back</button><button class=flex-1>Go');function so(n){let e,t;const[s,r]=O(!1),[i,a]=O(!1),[o,l]=O(""),c=async()=>{r(!1);var d=e.value.trim();d=d.toUpperCase(),d!==""&&(await wa(d)?(l(d),n.setPlayerState(2)):(console.log("Invalid game Id"),r(!0)))},u=async()=>{a(!1);const d=t.value;d!==""&&(console.log("user"),await ba(d,o())?(console.log("register"),va(o(),d),n.setPlayerState(0)):(console.log("error"),a(!0)))};return(()=>{var d=Xa(),h=d.firstChild;return $(h,(()=>{var f=L(()=>n.playerState===0);return()=>f()&&[Za(),(()=>{var g=eo(),y=g.firstChild,p=y.nextSibling;return At(y,"click",_a,!0),p.$$click=()=>n.setPlayerState(1),g})()]})(),null),$(h,(()=>{var f=L(()=>n.playerState===1);return()=>f()&&(()=>{var g=to(),y=g.firstChild,p=y.nextSibling,b=p.nextSibling,k=b.firstChild,v=k.nextSibling;p.$$keydown=w=>{w.key==="Enter"&&c()};var m=e;return typeof m=="function"?je(m,p):e=p,$(g,()=>(()=>{var w=Vn();return $(w,()=>s()?"Invalid game code":""),w})(),b),k.$$click=()=>n.setPlayerState(0),v.$$click=c,g})()})(),null),$(h,(()=>{var f=L(()=>n.playerState===2);return()=>f()&&(()=>{var g=no(),y=g.firstChild,p=y.nextSibling,b=p.nextSibling,k=b.firstChild,v=k.nextSibling;p.$$keydown=w=>{w.key==="Enter"&&u()};var m=t;return typeof m=="function"?je(m,p):t=p,$(g,()=>(()=>{var w=Vn();return $(w,()=>i()?"Username taken":""),w})(),b),k.$$click=()=>n.setPlayerState(1),v.$$click=u,g})()})(),null),d})()}ot(["click","keydown"]);var ro=T('<div class="w-screen h-[100svh]">');pa();function io(){const[n,e]=O(0);return he(()=>{document.addEventListener("beforeunload",t=>{_.user_type==="host"?$s():_.user_type==="player"&&xs(),t.preventDefault()})}),(()=>{var t=ro();return $(t,(()=>{var s=L(()=>_.user_type==="host");return()=>s()?B(za,{}):(()=>{var r=L(()=>_.user_type==="player");return()=>r()?B(Ya,{}):B(so,{setPlayerState:e,get playerState(){return n()}})})()})()),t})()}const ao=document.getElementById("root");Ys(()=>B(io,{}),ao);export{pr as g};
